#!/bin/sh

# Assurez-vous que les conteneurs Docker sont en cours d'exÃ©cution
if ! docker compose ps --services --status running | grep -q "frontend\|backend"; then
  echo "âš ï¸ Les conteneurs Docker ne sont pas en cours d'exÃ©cution. DÃ©marrez-les avec 'docker compose up -d'."
  exit 1
fi

# Format (localement)
echo "ğŸ’… Formatage du code..."
npm run format
if [ $? -ne 0 ]; then
  echo "âŒ Le formatage a Ã©chouÃ©."
  exit 1
fi

# Lint backend
echo "ğŸ”§ VÃ©rification du backend..."
npm run lint:backend
if [ $? -ne 0 ]; then
  echo "âŒ Le linting du backend a Ã©chouÃ©. Corrigez les erreurs avant de commiter."
  exit 1
fi

# Lint frontend
echo "ğŸ”§ VÃ©rification du frontend..."
npm run lint:frontend
if [ $? -ne 0 ]; then
  echo "âŒ Le linting du frontend a Ã©chouÃ©. Corrigez les erreurs avant de commiter."
  exit 1
fi

# Ajouter les fichiers formatÃ©s au commit
git add .

echo "âœ… Les vÃ©rifications de code sont passÃ©es !"